BUILD_DELTA_EE_REVIEW_TABLE:  
select qlik_build_review_answers('2015-01-01', '2015-01-01');
select qlik_build_answer_pivot_views('2015-01-01', '2015-01-01', "ARRAY['review']");
DROP TABLE BUILD_DELTA_EE_REVIEW_TABLE; 

Temp_Client_Review_Answer:
select * from qlik_review_answer_pivot_view;

Client_Review_Answer:
Noconcatenate
LOAD DISTINCT
sec_key AS %SA_EE_REVIEW_ANSWER,
entry_exit_review_id AS [Entry Exit Review Id]
*
RESIDENT Temp_Client_Review_Answer;
DROP TABLE Temp_Client_Review_Answer;

DROP FIELDS sec_key,entry_exit_review_id FROM Client_Review_Answer;


FACT_Entry_Exit_Review:
Noconcatenate
Load Distinct
[Entry Exit Review Id]
RESIDENT Temp_Client_Review_Answer;



Temp_FACT_Entry_Exit_Review:
SELECT
eer.entry_exit_review_id,
plv(eer.point_in_time_type_id) as entry_exit_review_pit_type,
plv(eer.review_type_id) as entry_exit_review_type,
eer.review_date::DATE as entry_exit_review_date,
eer.entry_exit_id
FROM
sp_entry_exit_review eer
WHERE active =true;

inner join(FACT_Entry_Exit_Review)
LOAD
	entry_exit_review_id				 AS [Entry Exit Review Id],
	entry_exit_id 						 AS [Entry Exit Id],
	entry_exit_review_pit_type 			 AS [Entry Exit Review PIT Type],
	entry_exit_review_type 				 AS [Entry Exit Review Type],
	entry_exit_review_date 			     AS [Entry Exit Review Date],
	entry_exit_review_id				 AS  match_review_id
RESIDENT  Temp_FACT_Entry_Exit_Review;
DROP TABLE Temp_FACT_Entry_Exit_Review;
 







